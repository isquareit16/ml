import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.optimizers import Adam
from sklearn.preprocessing import LabelEncoder
data=pd.read_csv("ANN_Bank_Marketing.csv")
data
le=LabelEncoder()
for col in data.columns:
    data[col]=le.fit_transform(data[col])
data
x=data.drop('y',axis=1)
y=data['y']
data
scaler=StandardScaler()
x_scaled=scaler.fit_transform(x)
x_train,x_test,y_train,y_test=train_test_split(x_scaled,y,test_size=0.25,random_state=42)
model=Sequential([
    Dense(16,input_dim=x_train.shape[1],activation='relu'),
    Dense(8,activation='relu'),
    Dense(1,activation='sigmoid')
])
model.compile(optimizer=Adam(learning_rate=0.001),
              loss='binary_crossentropy',
              metrics=['accuracy'])
history = model.fit(x_train, y_train, epochs=50, batch_size=16, validation_data=(x_test, y_test), verbose=1)


plt.figure(figsize=(10,4))
plt.subplot(1,2,1)
plt.plot(history.history['accuracy'],label='train',color='b')
plt.plot(history.history['val_accuracy'],label='test',color='r')
plt.legend()
plt.title('Accuracy')

